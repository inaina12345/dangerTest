name: Danger Summary CI Test

on:
  pull_request:

env:
  DANGER_GITHUB_API_TOKEN: ${{ secrets.GITHUB_TOKEN }}

jobs:
  build:
    name: Danger Summary CI Test
    runs-on: self-hosted

    steps:
      - name: Checkout
        uses: actions/checkout@v4
        with:
          fetch-depth: 0
#      - name: xcodebuild
#        run:
#         xcodebuild build
#         -project swiftUI_XCUITest.xcodeproj
#         -scheme swiftUI_XCUITest
#         -destination "id=B7C1A209-ACF8-4012-BB21-14B7CDBD3808"
#         OTHER_SWIFT_FLAGS="-Xfrontend -warn-long-function-bodies=100"
#         > build.log
      - name: xcodebuild test
        # エラーでも処理を継続する
        continue-on-error: true
        run:
         xcodebuild test
         -project swiftUI_XCUITest.xcodeproj
         -scheme swiftUI_XCUITestUTTests
         -destination "id=B7C1A209-ACF8-4012-BB21-14B7CDBD3808"
         -resultBundlePath test_output/ResultBundle.xcresult
      - name: bundle install
        run:
          bundle install
      - name: exec danger
        run:
          bundle exec danger
#      - name: Danger CI Test
#        env:
#         DANGER_GITHUB_API_TOKEN: ${{ secrets.GITHUB_TOKEN }}
#        run: |
#         brew install danger/tap/danger-swift
#         # Run danger
#         danger-swift ci

      #- name: Danger JS
      #  uses: danger/danger-js@X.Y.Z
      #  env:
      #    GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
